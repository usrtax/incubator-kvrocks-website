"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[967],{3905:function(e,n,t){t.d(n,{Zo:function(){return l},kt:function(){return d}});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var c=a.createContext({}),p=function(e){var n=a.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},l=function(e){var n=p(e.components);return a.createElement(c.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,s=e.originalType,c=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),m=p(t),d=r,h=m["".concat(c,".").concat(d)]||m[d]||u[d]||s;return t?a.createElement(h,o(o({ref:n},l),{},{components:t})):a.createElement(h,o({ref:n},l))}));function d(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var s=t.length,o=new Array(s);o[0]=m;var i={};for(var c in n)hasOwnProperty.call(n,c)&&(i[c]=n[c]);i.originalType=e,i.mdxType="string"==typeof e?e:r,o[1]=i;for(var p=2;p<s;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},7826:function(e,n,t){t.r(n),t.d(n,{assets:function(){return l},contentTitle:function(){return c},default:function(){return d},frontMatter:function(){return i},metadata:function(){return p},toc:function(){return u}});var a=t(7462),r=t(3366),s=(t(7294),t(3905)),o=["components"],i={},c="Namespace",p={unversionedId:"UserGuide/namespace",id:"UserGuide/namespace",title:"Namespace",description:"Like the Redis database, Kvrocks uses the namespace to isolate the data between users,",source:"@site/docs/03-UserGuide/01-namespace.md",sourceDirName:"03-UserGuide",slug:"/UserGuide/namespace",permalink:"/docs/UserGuide/namespace",draft:!1,editUrl:"https://github.com/apache/incubator-kvrocks-website/tree/main/docs/03-UserGuide/01-namespace.md",tags:[],version:"current",lastUpdatedBy:"Ruixiang Tan",lastUpdatedAt:1662905954,formattedLastUpdatedAt:"9/11/2022",sidebarPosition:1,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Info Section Explanation",permalink:"/docs/UserGuide/info-section-explain"},next:{title:"Design Complex Structure On Rocksdb",permalink:"/docs/Design/design-structure-on-rocksdb"}},l={},u=[{value:"Manage Namespace",id:"manage-namespace",level:2},{value:"Switch Namespace",id:"switch-namespace",level:2},{value:"How Kvrocks implement the namespace",id:"how-kvrocks-implement-the-namespace",level:2}],m={toc:u};function d(e){var n=e.components,t=(0,r.Z)(e,o);return(0,s.kt)("wrapper",(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"namespace"},"Namespace"),(0,s.kt)("p",null,"Like the Redis database, Kvrocks uses the namespace to isolate the data between users,\nbut unlike Redis, each namespace has its own password. The data would be stored in the\ndefault namespace when using ",(0,s.kt)("inlineCode",{parentName:"p"},"requirepass"),". The namespace would have\nno effect when the cluster mode was enabled like the Redis DB."),(0,s.kt)("h2",{id:"manage-namespace"},"Manage Namespace"),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"requirepass")," MUST be set if you want to add namespaces since we treat the ",(0,s.kt)("inlineCode",{parentName:"p"},"requirepass"),"\nuser as administrator."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"# Auth with the requirepass\n> redis-cli -p 6666 -a ${REQUIREPASS}\n\n# Add a new namespace with the token, the namespace name must be unique.\n127.0.0.1:6666> namespace add ${NEW NAMESPACE} ${NEW TOKEN}\n\n# Update the namespace's token\n127.0.0.1:6666> namespace set ${NAMESPACE} ${NEW TOKEN}\n\n# Delete the namespace, the namespace's data WOULD NOT be deleted,\n# unless you use the `flushdb` command to flush the DB data.\n127.0.0.1:6666> namespace del ${NAMESPACE}\n\n# Get the namespace's token\n127.0.0.1:6666> namespace get ${NAMESPACE}\n\n# List namespaces\n127.0.0.1:6666> namespace get *\n")),(0,s.kt)("p",null,"Be careful that you MUST use the ",(0,s.kt)("inlineCode",{parentName:"p"},"config rewrite")," command to persist\nthe new namespaces into the config file."),(0,s.kt)("h2",{id:"switch-namespace"},"Switch Namespace"),(0,s.kt)("p",null,"Firstly, we use the namespace command to create namespace ",(0,s.kt)("inlineCode",{parentName:"p"},"ns1")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"ns2")," with the corresponding tokens ",(0,s.kt)("inlineCode",{parentName:"p"},"token1")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"token2"),"."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},"127.0.0.1:6666> namespace add ns1 token1\n127.0.0.1:6666> namespace add ns2 token2\n")),(0,s.kt)("p",null,"Then we can use ",(0,s.kt)("inlineCode",{parentName:"p"},"token1")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"token2"),", operate data between namespaces would NOT affect each other like below:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-shell"},'\n# Use token1 to switch to ns1\n127.0.0.1:6666> auth token1\nOK\n127.0.0.1:6666> set key 100\nOK\n127.0.0.1:6666> get key\n"100"\n\n# Use token2 to switch to ns2\n127.0.0.1:6666> auth token2\nOK\n127.0.0.1:6666> set key 200\nOK\n127.0.0.1:6666> get key\n"200"\n\n# Use token1 to switch to ns1 again, the value is still 100\n127.0.0.1:6666> auth token1\nOK\n127.0.0.1:6666> get key\n"100"\n\n')),(0,s.kt)("h2",{id:"how-kvrocks-implement-the-namespace"},"How Kvrocks implement the namespace"),(0,s.kt)("p",null,"Kvrocks simply prepend the namespace prefix to the user key and remove it before retrieving.\nFor example, we create a new namespace ",(0,s.kt)("inlineCode",{parentName:"p"},"foo")," with token ",(0,s.kt)("inlineCode",{parentName:"p"},"bar"),", then the ",(0,s.kt)("inlineCode",{parentName:"p"},"foo")," would prepend\nto the user key. Another way was to split the namespace into different rocksdb column families,\nbut we didn't do that for the sake of simplicity."))}d.isMDXComponent=!0}}]);